CREATE OR REPLACE  DIRECTORY wfmt_dumps AS 'C:\Users\611903295\Downloads\Creating_dumping_archieve_wfmt_records';


DROP TABLE WFMT_EXT_DUMP


CREATE TABLE WFMT_EXT_DUMP(
        EQUIPMENT CHAR(10),
        CP_NUMBER CHAR(20),
        SCHEME CHAR(20)
)
ORGANIZATION EXTERNAL
(
TYPE ORACLE_LOADER
DEFAULT DIRECTORY "wfmt_dumps"
ACCESS PARAMETERS
(
RECORDS DELIMITED BY NEWLINE
FIELDS TERMINATED BY ','
REJECT ROWS WITH ALL NULL VALUES
MISSING FIELDS VALUES ARE NULL
(
    EQUIPMENT CHAR(10),
    CP_NUMBER CHAR(10),
    SCHEME CHAR(10)
)
)
LOCATION('wfmt.txt')
);

/* HERE SKIPPING ONE OF THE RECORD IN THE EXTER DATA FILE*/
/** HERE ALSO WE ARE WE ARE ALLOWING UNLIMITED REJECTED FILES */
CREATE TABLE WFMT_EXT_DUMP(
        EQUIPMENT CHAR(10),
        CP_NUMBER CHAR(20),
        SCHEME CHAR(20)
)
ORGANIZATION EXTERNAL
(
TYPE ORACLE_LOADER
DEFAULT DIRECTORY "wfmt_dumps"
ACCESS PARAMETERS
(
RECORDS DELIMITED BY NEWLINE
SKIP 2
FIELDS TERMINATED BY ','
REJECT ROWS WITH ALL NULL VALUES
MISSING FIELDS VALUES ARE NULL
(
    EQUIPMENT CHAR(10),
    CP_NUMBER CHAR(10),
    SCHEME CHAR(10)
)
)
LOCATION('wfmt.txt')
)
REJECT LIMIT UNLIMITED;

SELECT * FROM WFMT_EXT_DUMP;
